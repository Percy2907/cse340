<main class="review-page">
  <h1><%= title %></h1>

  <%- messages() %>

  <% if (errors) { %>
    <ul class="notice">
      <% errors.array().forEach(error => { %>
        <li><%= error.msg %></li>
      <% }) %>
    </ul>
  <% } %>

  <div class="review-info">
    <p>Share your experience with the <strong><%= vehicleName %></strong></p>
  </div>

  <form id="addReviewForm" action="/review/add" method="post">
    <fieldset>
      <legend>Write Your Review</legend>

      <label for="review_rating">Rating (1-5 stars):</label>
      <div class="star-rating-input">
        <input 
          type="radio" 
          name="review_rating" 
          value="5" 
          id="star5"
          <%= locals.review_rating == '5' ? 'checked' : '' %>
        >
        <label for="star5">★</label>

        <input 
          type="radio" 
          name="review_rating" 
          value="4" 
          id="star4"
          <%= locals.review_rating == '4' ? 'checked' : '' %>
        >
        <label for="star4">★</label>

        <input 
          type="radio" 
          name="review_rating" 
          value="3" 
          id="star3"
          <%= locals.review_rating == '3' ? 'checked' : '' %>
        >
        <label for="star3">★</label>

        <input 
          type="radio" 
          name="review_rating" 
          value="2" 
          id="star2"
          <%= locals.review_rating == '2' ? 'checked' : '' %>
        >
        <label for="star2">★</label>

        <input 
          type="radio" 
          name="review_rating" 
          value="1" 
          id="star1"
          <%= locals.review_rating == '1' ? 'checked' : '' %>
          required
        >
        <label for="star1">★</label>
      </div>

      <label for="review_text">Your Review:</label>
      <textarea 
        name="review_text" 
        id="review_text" 
        required
        minlength="10"
        maxlength="1000"
        placeholder="Share your thoughts about this vehicle... (10-1000 characters)"
        rows="6"
      ><%= locals.review_text %></textarea>
      <p class="char-count"><span id="charCount">0</span>/1000 characters</p>

      <input type="hidden" name="inv_id" value="<%= inv_id %>">

      <button type="submit">Submit Review</button>
      <a href="/inv/detail/<%= inv_id %>" class="cancel-btn">Cancel</a>
    </fieldset>
  </form>
</main>

<style>
.review-page {
  max-width: 800px;
  margin: 0 auto;
  padding: 20px;
}

.review-info {
  background-color: #f0f8ff;
  padding: 15px;
  border-left: 4px solid #007bff;
  margin-bottom: 20px;
  border-radius: 4px;
}

.star-rating-input {
  display: flex;
  flex-direction: row-reverse;
  justify-content: flex-end;
  gap: 5px;
  font-size: 2em;
  margin-bottom: 20px;
}

.star-rating-input input[type="radio"] {
  display: none;
}

.star-rating-input label {
  cursor: pointer;
  color: #ddd;
  transition: color 0.2s;
}

.star-rating-input input[type="radio"]:checked ~ label,
.star-rating-input label:hover,
.star-rating-input label:hover ~ label {
  color: #ffc107;
}

.char-count {
  text-align: right;
  font-size: 0.9em;
  color: #666;
  margin-top: -5px;
}

.cancel-btn {
  display: inline-block;
  margin-left: 10px;
  padding: 12px 30px;
  background-color: #6c757d;
  color: white;
  text-decoration: none;
  border-radius: 5px;
  transition: background-color 0.3s;
}

.cancel-btn:hover {
  background-color: #5a6268;
}
</style>

<script>
// Character counter
const textarea = document.getElementById('review_text');
const charCount = document.getElementById('charCount');

function updateCharCount() {
  charCount.textContent = textarea.value.length;
}

textarea.addEventListener('input', updateCharCount);
updateCharCount();
</script>