<% if (title) { %>
<h1><%= title %></h1>
<% } else {
  res.redirect('/')
} %>

<%- messages() %>

<% if (errors) { %>
  <ul class="notice">
  <% errors.array().forEach(error => { %>
    <li><%= error.msg %></li>
  <% }) %>
  </ul>
<% } %>

<form id="addClassificationForm" action="/inv/add-classification" method="post">
  <fieldset class="blue-fieldset">
    <p class="field-required">FIELD IS REQUIRED.</p>
    
    <label for="classificationName">Classification Name</label>
    <p class="field-instruction">NAME MUST BE ALPHABETIC CHARACTERS ONLY.</p>
    <input 
      type="text" 
      id="classificationName" 
      name="classification_name" 
      required 
      pattern="[A-Za-z0-9]+"
      title="Classification name cannot contain spaces or special characters"
      value="<%= locals.classification_name || '' %>"
    >
    
    <input type="submit" value="Add Classification" class="submit-btn">
  </fieldset>
</form>

<script>
  // Client-side validation
  const form = document.querySelector("#addClassificationForm");
  const classificationInput = document.querySelector("#classificationName");
  const fieldset = document.querySelector(".blue-fieldset");
  
  // Create error message element
  let errorMsg = document.createElement("p");
  errorMsg.className = "validation-error";
  errorMsg.style.display = "none";
  errorMsg.textContent = "• Provide a correct classification name.";
  fieldset.insertBefore(errorMsg, fieldset.firstChild);
  
  // Form submission validation
  form.addEventListener("submit", function(event) {
    const pattern = /^[A-Za-z0-9]+$/;
    
    if (!classificationInput.value) {
      errorMsg.textContent = "• Provide a correct classification name.";
      errorMsg.style.display = "block";
      event.preventDefault();
      return;
    }
    
    if (!pattern.test(classificationInput.value)) {
      errorMsg.textContent = "• Provide a correct classification name.";
      errorMsg.style.display = "block";
      event.preventDefault();
      return;
    }
  });
</script>
